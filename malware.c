#include <Windows.h>

char *getPath();
int  autorun(char*);
void setup();

int main(int argc, char **argv) {
    if(argc != 2)
        setup();
    // process
    return 0;
}

char *getPath() {
    char PATH[MAX_PATH];
    GetModuleFileName(NULL, PATH, MAX_PATH);
    return PATH;
}

int autorun(char *sh) {
    //
}

void setup() {
    char *shell = getPath();
    strcat(shell, " d");
    if(autorun(shell) != 0) {
        // fix the problem
    }
    // Next process
}